# Lamp Control

**‚è±Ô∏è Estimated time:** 30 minutes  
**üîß Required tools:** Computer with LeLamp runtime  
**üì¶ Required:** Fully assembled LeLamp with working head and body

For complete lamp control documentation, refer to the [**LeLamp Runtime's GitHub**](https://github.com/humancomputerlab/lelamp_runtime).

To follow this tutorial, ssh into your LeLamp and cd into `lelamp_runtime`. This was covered in the previous tutorial.

In commands below, remember to replace the name after `--id` to be your lamp name that you have used in previous section.

## Calibration

Before recording and replaying movements on the lamp, you need to calibrate:

```bash
sudo uv run -m lelamp.calibrate --id your_lamp_name --port your_port
```

The calibration script will run calibration twice, once for the lamp as a follower and once for the lamp as the leader. Follow the step outlined inside the CLI.

The script will mention you to put LeLamp into its zero position. The zero position is can be view in 3D [here](https://cad.onshape.com/documents/16c9706360b5ad34f9c8db49/w/2edfa54c83253c120fbc9e58/e/9bd935d578a9cbc77b5d66b3).

After putting LeLamp into its zero position, rotate each joint fully except for the lamp base motor (first motor on the base) or the lamp head motor (second motor from lamp head). **‚ö†Ô∏è Important: Do not fully rotate the lamp base or lamp head during calibration ‚Äî this applies specifically to the two yaw servos. When setting them to their zero position, only rotate each servo about 90¬∞ clockwise and 90¬∞ counterclockwise from the center position. Rotating beyond this range may damage the servos or misalign the calibration.**

## Record and replay movements

To record movement, run the following command in runtime:

```bash
sudo uv run -m lelamp.record --id your_lamp_name --port your_port --name rotation
```

While recording movement, you can end and save the recording by holding `CTRL + C`.

To replay movement, run the following command in runtime:

```bash
sudo uv run -m lelamp.replay --id your_lamp_name --port your_port --name rotation
```

To list all recorded movements, run the following command in runtime:

```bash
sudo uv run -m lelamp.list_recordings --id your_lamp_name
```

## Final System Testing

After completing your LeLamp build, perform these final tests:

### Full System Integration Test

```bash
# Test all servo movements
sudo uv run -m lelamp.test.test_motors --id your_lamp_name --port your_port

# Test head components
sudo uv run -m lelamp.test.test_rgb     # LED ring
uv run -m lelamp.test.test_audio        # Audio I/O
libcamera-hello --timeout 2000         # Camera
```

### Record Your First Movement

1. **Position LeLamp** in a safe working area with full range of motion
2. **Record a simple movement** to test the system
3. **Replay the movement** to verify accuracy
4. **Save successful recordings** for future use

## Congratulations! üéâ

You have successfully built your LeLamp! Your robot lamp should now be capable of:

- ‚úÖ Expressive movement through 5 degrees of freedom
- ‚úÖ Visual interaction via camera
- ‚úÖ Audio input/output for voice interaction
- ‚úÖ Programmable LED expressions
- ‚úÖ Recording and replaying custom movements

## Next Steps

- **Explore the runtime**: Check out advanced features in the [LeLamp Runtime repository](https://github.com/humancomputerlab/lelamp_runtime)
- **Join the community**: Share your build on [Discord](https://discord.gg/4hmNW3Ep)
- **Contribute back**: Help improve documentation or share build photos
- **Report issues**: Use [GitHub Issues](https://github.com/humancomputerlab/le_lamp/issues) for bugs or suggestions

---

**Previous**: [LeLamp Setup](./4.%20LeLamp%20Setup.md) | **Troubleshooting**: [Common Issues](./6.%20Common%20Issues.md)
